<!DOCTYPE html>
<title>Traveller Map - Sector Data Checker</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="shortcut icon" href="../favicon.ico">
<link rel="stylesheet" type="text/css" href="../site.css?update=2014-01-26">
<script src="../lib/polyfill/polyfill.js?update=2014-03-13"></script>
<script src="../lib/polyfill/es6.js?update=2014-03-21"></script>
<script src="../map.js?update=2014-06-23"></script>
<style>
  #input, #output {
    width: 1000px; height: 300px; 
    white-space: pre;
    overflow: scroll;
  } 

  .pass #summary { color: #008000; }
  .fail #summary { color: #800000; }

  #results { display: none; }
  .pass #results, .fail #results { display: initial; }

</style>
<h1>Traveller Map - Sector Data Checker</h1>
<div><textarea id="input" wrap="off" placeholder="Paste sector data here (SEC, T5 tab delimited, or T5 column delimited)"></textarea></div>
<div><button id="go">Check</button></div>
<div id="results">
  <h3>Results: <span id="summary"></span></h3>
  <div><textarea id="output" wrap="off" readonly></textarea></div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    'use strict';
    var $ = function (s) { return document.querySelector(s); };

    $('#go').addEventListener('click', function () {
      var input = $('#input').value;
      var xhr = new XMLHttpRequest(), async = true;
      xhr.open('POST', SERVICE_BASE + '/api/sec' + '?lint=1', async);
      xhr.setRequestHeader('Content-Type', 'text/plain');
      xhr.send(input);
      xhr.onreadystatechange = function () {
        if (xhr.readyState !== XMLHttpRequest.DONE) return;
        if (xhr.status === 200) {
          document.body.classList.add('pass');
          document.body.classList.remove('fail');
          $('#summary').innerHTML = '\u2713 No errors found';
          $('#output').value = xhr.responseText;
        } else {
          document.body.classList.add('fail');
          document.body.classList.remove('pass');
          $('#summary').innerHTML = '\u2717 Errors found';
          $('#output').value = xhr.responseText;
        }
      };
    });
  });

</script>
<div class="editorial">
  <p>
    The <em class="product">Traveller</em> game in all forms is owned by Far
    Future Enterprises. Copyright &copy; 1977 &ndash; 2014 Far Future
    Enterprises.
    <a href="http://farfuture.net/FFEFairUsePolicy2008.pdf">Fair Use Policy</a>
</div>
